<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Slide Factory | Consulting Dashboard</title>
    <style>
        :root { --bg: #0f172a; --panel: #1e293b; --accent: #38bdf8; --text: #f1f5f9; }
        body { margin: 0; display: flex; height: 100vh; background: var(--bg); color: var(--text); font-family: 'Inter', system-ui, sans-serif; }
        
        /* å·¦ä¾§æ§åˆ¶é¢æ¿ */
        #sidebar { width: 350px; background: var(--panel); padding: 30px; display: flex; flex-direction: column; border-right: 1px solid #334155; box-shadow: 10px 0 15px rgba(0,0,0,0.2); z-index: 10; }
        h1 { font-size: 1.5rem; margin-bottom: 2rem; color: var(--accent); letter-spacing: -1px; }
        label { font-size: 0.8rem; text-transform: uppercase; color: #94a3b8; margin-bottom: 8px; display: block; }
        
        input { background: #0f172a; border: 1px solid #334155; color: white; padding: 12px; border-radius: 8px; margin-bottom: 20px; font-size: 1rem; width: 100%; box-sizing: border-box; }
        input:focus { outline: none; border-color: var(--accent); }
        
        button { background: var(--accent); color: #0f172a; border: none; padding: 15px; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.3s; font-size: 1rem; }
        button:hover { filter: brightness(1.2); transform: translateY(-2px); }
        
        #status-box { margin-top: auto; padding: 15px; background: #0f172a; border-radius: 8px; font-size: 0.85rem; border-left: 4px solid var(--accent); }
        .dot { height: 8px; width: 8px; background-color: var(--accent); border-radius: 50%; display: inline-block; margin-right: 5px; animation: pulse 1s infinite; }
        
        /* å³ä¾§é¢„è§ˆåŒº */
        #main-view { flex: 1; position: relative; background: #000; }
        iframe { width: 100%; height: 100%; border: none; }
        
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }
    </style>
</head>
<body>

    <div id="sidebar">
        <h1>SLIDE FACTORY</h1>
        
        <label>å¹»ç¯ç‰‡ä¸»é¢˜ (Topic)</label>
        <input type="text" id="topic" placeholder="ä¾‹å¦‚: æ•°å­—åŒ–è½¬å‹å’¨è¯¢æ–¹æ¡ˆ...">
        
        <label>ç›®æ ‡å—ä¼— (Target Audience)</label>
        <input type="text" id="audience" placeholder="ä¾‹å¦‚: ä¼ä¸šé«˜ç®¡ã€æŠ•èµ„è€…...">
        
        <button onclick="generateSlide()">ğŸš€ å¼€å§‹ä¸€é”®ç”Ÿæˆ</button>

        <div id="status-box">
            <span class="dot"></span> ç³»ç»ŸçŠ¶æ€: <span id="status-text">å°±ç»ª (Ready)</span>
        </div>
    </div>

    <div id="main-view">
        <iframe id="preview" src="http://localhost:3030"></iframe>
    </div>

    <script>
        async function generateSlide() {
            const topic = document.getElementById('topic').value;
            const audience = document.getElementById('audience').value;
            const statusText = document.getElementById('status-text');
            const preview = document.getElementById('preview');

            if (!topic) return alert("è¯·è¾“å…¥ä¸»é¢˜");

            statusText.innerText = "æ­£åœ¨åŒæ­¥ AI å†…å®¹...";
            
            try {
                // è¿™é‡Œå¯¹æ¥ä½ çš„ n8n Webhook
                await fetch('http://localhost:5678/webhook-test/create-ppt', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ topic: topic, audience: audience })
                });

                statusText.innerText = "å†…å®¹å·²åˆ°è¾¾åç«¯ï¼Œæ­£åœ¨ç¼–è¯‘...";
                
                // è½®è¯¢ç­‰å¾…åç«¯å†™å…¥æ–‡ä»¶å¹¶ Slidev åˆ·æ–°
                setTimeout(() => {
                    preview.contentWindow.location.reload();
                    statusText.innerText = "ç”ŸæˆæˆåŠŸï¼";
                }, 5000);

            } catch (err) {
                statusText.innerText = "è¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ";
            }
        }
    </script>
</body>
</html>